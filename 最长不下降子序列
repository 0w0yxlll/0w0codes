#include<iostream>
#include<stdio.h>
#include<string.h>

using namespace std;

long long d[100000],a[100000];
long long len,k,n;

void input()
{
	cin>>n;
	for(long long i=1;i<=n;i++) cin>>a[i];	
}

long long min(long long t)
{
	long long s,w,mid;
	s=0;
	w=len;
	while(s<w)
	{
		mid=(s+w)/2;
		if(d[mid]<=t) s=mid+1;
		else w=mid;
	}
	return	s;
}

void solve()
{
	len=0;
	d[0]=-29888888;//设一个非常小的数字
	for(long long i=1;i<=n;i++)
	{
		if(a[i]>=d[len])
		{
			len++;
			d[len]=a[i];
			cout<<d[len]<<"";
		}//放置数组
		else
		{
			k=min(a[i]);
			d[k]=a[i];
		}
	}
	cout<<endl;
	cout<<len<<endl;
}

int main()
{
	input();
	solve();
	return 0;
}
